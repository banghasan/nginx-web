server {
    # ğŸ“¢ Listen ke Port 80 (HTTP)
    listen 80;
    listen [::]:80;
    server_name __domain;

    # ğŸ“ Document Root yang diminta
    root /nginx/var/html;
    index index.html index.htm;

    ## ğŸ“ Lokasi Utama
    location / {
        # Mencoba melayani sebagai file, lalu sebagai direktori.
        # Fallback ke /index.html (baik untuk SPA atau server statis)
        try_files $uri $uri/ /index.html;
    }

    ## ğŸš« Lokasi Terlarang (Security)

    # Mencegah akses ke file yang tersembunyi
    location ~ /\. {
        deny all;
    }

    location /health {
        # Menetapkan tipe konten sebagai JSON
        default_type application/json;

        # Menggunakan modul 'return' untuk merespon dengan kode status 200 OK
        # dan body JSON yang ditentukan
        return 200 '{"status": "ok"}';
    }

    ## ğŸ–¼ï¸ Caching untuk aset statis (Performa)

    #location ~* \.(jpg|jpeg|png|gif|ico|css|js|woff2?|ttf|eot|svg)$ {
        # Mengatur cache yang lama (1 tahun)
    #    expires 365d;
    #    log_not_found off;
    #}

    ## ğŸ›¡ï¸ Header untuk Reverse Proxy (Opsional)
    # Karena Anda menggunakan reverse proxy, pastikan Nginx merekam IP asli klien, bukan IP proxy.
    # Header ini biasanya dikirim oleh reverse proxy Anda (misalnya: X-Forwarded-For)
    # Jika Anda menggunakan proxy_pass ke backend, ini penting:
    # proxy_set_header X-Real-IP $remote_addr;
    # proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    # proxy_set_header X-Forwarded-Proto $scheme;
    # proxy_set_header Host $http_host;
}
